{"version":3,"sources":["editors/sync-worker.js"],"names":["define","modified_cache","reader","FileReader","self","addEventListener","e","multiplier","poll","readAsText","data","setTimeout","onload","file","modified","Date","lastModifiedDate","postMessage","body","target","result","size","total","lastModified","timeStamp"],"mappings":";;;;;;;AAAAA,UAAU,WAER,IAEIC,EAFAC,EAAS,IAAIC,WAIjBC,KAAKC,iBAAiB,UAAW,SAASC,GAExC,IAEIC,EAAa,EAEbC,EAAO,WACTN,EAAOO,WAAWH,EAAEI,MACpBC,WAAWH,EANE,IAMeD,IAG9BC,IAEAN,EAAOU,OAAS,SAASC,GACvB,IAAIC,GAAY,IAAIC,KAAKT,EAAEI,KAAKM,kBAE5Bf,IAAmBa,GAErBP,EAAa,EACbN,EAAiBa,EAEjBG,aACEC,KAAML,EAAKM,OAAOC,OAClBC,KAAMR,EAAKS,MACXC,aAAcV,EAAKW,oBAGdX,EAGLN,EAAa,IACfA,GAAc,MAGjB","file":"../../editors/sync-worker.js","sourcesContent":["define([],function(){\r\n  // directly from @wookiehangover's amazing demo: https://github.com/wookiehangover/pandaco.de\r\n  var reader = new FileReader();\r\n\r\n  var modified_cache;\r\n\r\n  self.addEventListener('message', function(e){\r\n\r\n    var interval = 500;\r\n\r\n    var multiplier = 1;\r\n\r\n    var poll = function(){\r\n      reader.readAsText(e.data);\r\n      setTimeout(poll, interval * multiplier);\r\n    };\r\n\r\n    poll();\r\n\r\n    reader.onload = function(file){\r\n      var modified = +new Date(e.data.lastModifiedDate);\r\n\r\n      if( modified_cache !== modified ){\r\n\r\n        multiplier = 1;\r\n        modified_cache = modified;\r\n\r\n        postMessage({\r\n          body: file.target.result,\r\n          size: file.total,\r\n          lastModified: file.timeStamp\r\n        });\r\n      } else {\r\n        delete file;\r\n      }\r\n\r\n      if( multiplier < 8 )\r\n        multiplier += 1;\r\n    };\r\n\r\n  }, false);\r\n});"]}