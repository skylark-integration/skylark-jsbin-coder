{"version":3,"sources":["editors/snapshot.js"],"names":["define","$","jsbin","coder","updateTitle","editors","snapshot","watchForSnapshots","document","on","localStorage","latest","state","code","revision","window","addEventListener","event","key","split","saveChecksum","checksum","history","replaceState","getURL"],"mappings":";;;;;;;AAAAA,QACE,iBACC,WACA,WACA,kBACD,SAAUC,EAAEC,EAAMC,EAAMC,GAwBxB,OAAOD,EAAME,QAAQC,UACnBC,kBAxBF,WAEE,aAEAN,EAAEO,UAAUC,GAAG,QAAS,WACtBC,aAAaC,OAAST,EAAMU,MAAMC,KAAO,IAAMX,EAAMU,MAAME,WAG7DC,OAAOC,iBAAiB,UAAW,SAAUC,GACzB,WAAdA,EAAMC,KACIR,aAAaC,OAAOQ,MAAM,KAC5B,KAAOjB,EAAMU,MAAMC,OAC3BX,EAAMU,MAAMD,QAAS,EACrBT,EAAMkB,cAAe,EACrBlB,EAAMU,MAAMS,UAAW,EACvBjB,IACAW,OAAOO,QAAQC,aAAa,KAAM,KAAMrB,EAAMsB,SAAW","file":"../../editors/snapshot.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"../jsbin\",\r\n   \"../coder\",\r\n   \"../updateTitle\"\r\n],function ($,jsbin,coder,updateTitle) {\r\n  function watchForSnapshots() {\r\n    /*globals $document, jsbin, updateTitle, saveChecksum*/\r\n    'use strict';\r\n\r\n    $(document).on('saved', function () {\r\n      localStorage.latest = jsbin.state.code + '/' + jsbin.state.revision;\r\n    });\r\n\r\n    window.addEventListener('storage', function (event) {\r\n      if (event.key === 'latest') {\r\n        var parts = localStorage.latest.split('/');\r\n        if (parts[0] === jsbin.state.code) {\r\n          jsbin.state.latest = false;\r\n          jsbin.saveChecksum = false; // jshint ignore:line\r\n          jsbin.state.checksum = false;\r\n          updateTitle();\r\n          window.history.replaceState(null, null, jsbin.getURL() + '/edit');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  return coder.editors.snapshot = {\r\n    watchForSnapshots\r\n  };\r\n});"]}