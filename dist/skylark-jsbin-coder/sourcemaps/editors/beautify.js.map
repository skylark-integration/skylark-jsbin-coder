{"version":3,"sources":["editors/beautify.js"],"names":["define","$","jsbin","coder","panels","settings","customKeys","keys","embed","disabled","ctrlKey","browser","platform","document","on","e","shiftKey","which","beautify","editors","focusedPanel","focused","beautifyUrls","html","css","js","state","processors","id","window","html_beautify","beautifyHTML","lazyLoadAndRun","css_beautify","beautifyCSS","js_beautify","beautifyJS","url","callback","getScript","done","runBeautifier","panel","beautifier","editor","setCode","getCode","indent_size","indentUnit"],"mappings":";;;;;;;AAAAA,QACE,iBACC,WACA,WACA,YACD,SAAUC,EAAEC,EAAMC,EAAMC,GACxB,aAGA,IAAIC,EAAWH,EAAMG,aACjBC,EAAaD,EAASE,SAE1B,IAAIL,EAAMM,QAASF,EAAWG,SAA9B,CAyDA,IAAIC,EAAiC,QAAvBT,EAAEU,QAAQC,SAAqB,UAAY,UASzD,OAPAX,EAAEY,UAAUC,GAAG,UAAW,SAA4BC,GAChDA,EAAEL,IAAYK,EAAEC,UAAuB,IAAXD,EAAEE,OAEhCC,MAIGf,EAAMgB,QAAQD,SAAYA,EA9DjC,SAASA,IAEP,IAAIE,EAAehB,EAAOiB,QACtBC,GACFC,KAAMrB,EAAc,OAAI,uCACxBsB,IAAKtB,EAAc,OAAI,sCACvBuB,GAAIvB,EAAc,OAAI,mCAGwB,SAA5CA,EAAMwB,MAAMC,WAAWP,EAAaQ,IACjCC,OAAOC,cAGVC,IAFAC,EAAeV,EAAaC,KAAMQ,GAIiB,QAA5C7B,EAAMwB,MAAMC,WAAWP,EAAaQ,IACxCC,OAAOI,aAGVC,IAFAF,EAAeV,EAAaE,IAAKU,GAIkB,eAA5ChC,EAAMwB,MAAMC,WAAWP,EAAaQ,MACxCC,OAAOM,YAGVC,IAFAJ,EAAeV,EAAaG,GAAIW,IAQtC,SAASJ,EAAeK,EAAKC,GAC3BrC,EAAEsC,UAAUF,GAAKG,KAAKF,GAGxB,SAASP,IACPU,EAAcrC,EAAOiB,QAASQ,OAAOC,eAGvC,SAASI,IACPO,EAAcrC,EAAOiB,QAASQ,OAAOI,cAGvC,SAASG,IACPK,EAAcrC,EAAOiB,QAASQ,OAAOM,aAGvC,SAASM,EAAcC,EAAOC,GAC5BD,EAAME,OAAOC,QAAQF,EAAWD,EAAME,OAAOE,WAC3CC,YAAa1C,EAASuC,QAASvC,EAASuC,OAAOI,YAAkB","file":"../../editors/beautify.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"../jsbin\",\r\n   \"../coder\",\r\n   \"./panels\"\r\n],function ($,jsbin,coder,panels) {\r\n  'use strict';\r\n  /*globals $, jsbin, objectValue */\r\n\r\n  var settings = jsbin.settings || {};\r\n  var customKeys = settings.keys || {};\r\n\r\n  if (jsbin.embed || customKeys.disabled) {\r\n    return;\r\n  }\r\n\r\n  function beautify() {\r\n\r\n    var focusedPanel = panels.focused;\r\n    var beautifyUrls = {\r\n      html: jsbin['static'] + '/js/vendor/beautify/beautify-html.js',\r\n      css: jsbin['static'] + '/js/vendor/beautify/beautify-css.js',\r\n      js: jsbin['static'] + '/js/vendor/beautify/beautify.js'\r\n    };\r\n\r\n    if (jsbin.state.processors[focusedPanel.id] === 'html') {\r\n      if (!window.html_beautify) {\r\n        lazyLoadAndRun(beautifyUrls.html, beautifyHTML);\r\n      } else {\r\n        beautifyHTML();\r\n      }\r\n    } else if (jsbin.state.processors[focusedPanel.id] === 'css') {\r\n      if (!window.css_beautify) {\r\n        lazyLoadAndRun(beautifyUrls.css, beautifyCSS);\r\n      } else {\r\n        beautifyCSS();\r\n      }\r\n    } else if (jsbin.state.processors[focusedPanel.id] === 'javascript') {\r\n      if (!window.js_beautify) {\r\n        lazyLoadAndRun(beautifyUrls.js, beautifyJS);\r\n      } else {\r\n        beautifyJS();\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  function lazyLoadAndRun(url, callback) {\r\n    $.getScript(url).done(callback);\r\n  }\r\n\r\n  function beautifyHTML() {\r\n    runBeautifier(panels.focused, window.html_beautify);\r\n  }\r\n\r\n  function beautifyCSS() {\r\n    runBeautifier(panels.focused, window.css_beautify);\r\n  }\r\n\r\n  function beautifyJS() {\r\n    runBeautifier(panels.focused, window.js_beautify);\r\n  }\r\n\r\n  function runBeautifier(panel, beautifier) {\r\n    panel.editor.setCode(beautifier(panel.editor.getCode(), {\r\n      indent_size: settings.editor ? settings.editor.indentUnit || 2 : 2\r\n    }));\r\n  }\r\n\r\n  var ctrlKey = $.browser.platform === 'mac' ? 'metaKey' : 'ctrlKey'\r\n\r\n  $(document).on('keydown', function beautifyKeyBinding(e) {\r\n    if (e[ctrlKey] && e.shiftKey && e.which == 76) {\r\n      // ctrl/command + shift + L\r\n      beautify();\r\n    }\r\n  });\r\n\r\n  return coder.editors.beautify =  beautify;\r\n\r\n});\r\n"]}