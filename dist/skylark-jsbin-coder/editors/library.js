/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","../coder","./panels","./libraries","../chrome/analytics"],function(e,r,n,i,t,a){var l=e("#library, #alt-library"),s={};function o(e,r,n){var i=new RegExp(r+"=('|\").+."+n+"\\1");return function(r){var n=r.match(i);return e+"("+n[0]+")"}}l.bind("init",function(){var e=0,r=0,n={},i=[],a={},o="",c="";for(s={},l.empty(),e=0;e<t.length;e++)c=(o=(n=t[e]).group||"Other").toLowerCase().replace(/[^a-z0-9]/gi,""),-1===i.indexOf(c)?(a={label:o,libraries:[],key:c},s[c]=a,i.push(c)):a=s[c],a.libraries.push(n);var d=['<option value="none">None</option>'];for(e=0;e<i.length;e++)for(a=s[i[e]],d.push('<option value="" data-group="'+a.label+'" class="heading">-------------</option>'),r=0;r<a.libraries.length;r++)n=a.libraries[r],d.push('<option value="'+a.key+":"+r+'">'+n.label+"</option>");l.html(d.join(""))}).trigger("init"),l.bind("change",function(){if(this.value){var r=this.value.split(":"),n=s[r[0]],t=n.libraries[r[1]];a.library("select",n.libraries[r[1]].label),function(r){e.isArray(r)||(r=[r]);var n,t,a,l=0,s=r.length,o="",c=i.named.html.getCode(),m={line:i.named.html.editor.currentLine(),character:i.named.html.editor.getCursor().ch,add:0},f=[],b="",g={},v={rel:"stylesheet",type:"text/css"};for(l=0;l<s;l++){for(var y in o=r[l],e.isPlainObject(o)?(a=o,o=o.url,delete a.url):a={},b=o.split("/").pop(),a=e.extend({},u(b)?v:g,a),t="",a)t+=" "+y+'="'+a[y]+'"';b&&c.indexOf(b+'"')&&(c=u(b)?c.replace(new RegExp('<link.*href=".*?/'+b+'".*?/>\n?'),""):c.replace(new RegExp('<script.*src=".*?/'+b+'".*?><\/script>\n?'),""),m.add--),n=u(o)?'<link href="'+o+'"'+t+" />":'<script src="'+o+'"'+t+"><\/script>",p()&&(n=u(o)?h(n):d(n)),f.push(n),m.add++}if(p()){var j=(c.match(/html.*\n(\s*)\S?/i)||[,])[1];c=c.trim()+"\n"+j+f.join("\n"+j).trim()}else if(-1!==c.indexOf("<head")){var x=c.split("\n");x.splice(m.line,0,f.join("\n")),c=x.join("\n")}else c=f.join("\n")+c;i.named.html.setCode(c),i.named.html.editor.setCursor({line:m.line+m.add,ch:m.character})}(t.url),t.snippet&&function(e){var r=i.named.html.getCode(),n={line:i.named.html.editor.currentLine(),character:i.named.html.editor.getCursor().ch,add:0};r=-1!==r.indexOf("</head")?r.replace(/<\/head>/i,e+"\n</head>"):e+"\n"+r;i.named.html.setCode(r),i.named.html.editor.setCursor({line:n.line+n.add,ch:n.character})}(t.snippet)}}).on("click",function(){a.library("open")});var c,d=o("script","src","js"),h=(c=o("link","href","css"),function(e){return c(e).split('" ').join('",')});function p(){return"jade"===r.state.processors.html}function u(e){return e.length-(e.lastIndexOf(".css")+4)==0}});
//# sourceMappingURL=../sourcemaps/editors/library.js.map
