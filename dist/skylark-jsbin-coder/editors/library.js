/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","../coder","./panels"],function(e,r,n,i){var t=e("#library, #alt-library"),a={};function l(e,r,n){var i=new RegExp(r+"=('|\").+."+n+"\\1");return function(r){var n=r.match(i);return e+"("+n[0]+")"}}t.bind("init",function(){var e=0,r=0,n={},i=[],l={},s="",o="";for(a={},t.empty(),e=0;e<libraries.length;e++)o=(s=(n=libraries[e]).group||"Other").toLowerCase().replace(/[^a-z0-9]/gi,""),-1===i.indexOf(o)?(l={label:s,libraries:[],key:o},a[o]=l,i.push(o)):l=a[o],l.libraries.push(n);var c=['<option value="none">None</option>'];for(e=0;e<i.length;e++)for(l=a[i[e]],c.push('<option value="" data-group="'+l.label+'" class="heading">-------------</option>'),r=0;r<l.libraries.length;r++)n=l.libraries[r],c.push('<option value="'+l.key+":"+r+'">'+n.label+"</option>");t.html(c.join(""))}).trigger("init"),t.bind("change",function(){if(this.value){var r=this.value.split(":"),n=a[r[0]],t=n.libraries[r[1]];analytics.library("select",n.libraries[r[1]].label),function(r){e.isArray(r)||(r=[r]);var n,t,a,l=0,s=r.length,p="",u=i.named.html.getCode(),f={line:i.named.html.editor.currentLine(),character:i.named.html.editor.getCursor().ch,add:0},m=[],b="",g={},v={rel:"stylesheet",type:"text/css"};for(l=0;l<s;l++){for(var y in p=r[l],e.isPlainObject(p)?(a=p,p=p.url,delete a.url):a={},b=p.split("/").pop(),a=e.extend({},h(b)?v:g,a),t="",a)t+=" "+y+'="'+a[y]+'"';b&&u.indexOf(b+'"')&&(u=h(b)?u.replace(new RegExp('<link.*href=".*?/'+b+'".*?/>\n?'),""):u.replace(new RegExp('<script.*src=".*?/'+b+'".*?><\/script>\n?'),""),f.add--),n=h(p)?'<link href="'+p+'"'+t+" />":'<script src="'+p+'"'+t+"><\/script>",d()&&(n=h(p)?c(n):o(n)),m.push(n),f.add++}if(d()){var j=(u.match(/html.*\n(\s*)\S?/i)||[,])[1];u=u.trim()+"\n"+j+m.join("\n"+j).trim()}else if(-1!==u.indexOf("<head")){var x=u.split("\n");x.splice(f.line,0,m.join("\n")),u=x.join("\n")}else u=m.join("\n")+u;i.named.html.setCode(u),i.named.html.editor.setCursor({line:f.line+f.add,ch:f.character})}(t.url),t.snippet&&function(e){var r=i.named.html.getCode(),n={line:i.named.html.editor.currentLine(),character:i.named.html.editor.getCursor().ch,add:0};r=-1!==r.indexOf("</head")?r.replace(/<\/head>/i,e+"\n</head>"):e+"\n"+r;i.named.html.setCode(r),i.named.html.editor.setCursor({line:n.line+n.add,ch:n.character})}(t.snippet)}}).on("click",function(){analytics.library("open")});var s,o=l("script","src","js"),c=(s=l("link","href","css"),function(e){return s(e).split('" ').join('",')});function d(){return"jade"===r.state.processors.html}function h(e){return e.length-(e.lastIndexOf(".css")+4)==0}});
//# sourceMappingURL=../sourcemaps/editors/library.js.map
