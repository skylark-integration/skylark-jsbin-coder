/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","../coder","./codemirror","./tern"],function(e,t,n,o){"use strict";if(!t.embed&&!t.mobile){var r=t.state.processors;t.settings.addons||(t.settings.addons={closebrackets:!0,highlight:!1,vim:!1,emacs:!1,trailingspace:!1,fold:!1,sublime:!1,tern:!1,activeline:!0,matchbrackets:!1});var i="open"in document.createElement("details"),s={},d={};["js","html","coffeescript","css"].forEach(function(e){var n=e+"hint",o=!1;"js"===e&&(o=!0),s[n]=void 0!==t.settings[n]?t.settings[n]:o}),(d=e.extend({},{console:!0,line:!1,under:!1,gutter:!1},t.settings.hintShow)).tooltip=d.gutter;var l=e.extend({},t.settings.addons,s),c={closebrackets:{url:"/js/vendor/codemirror5/addon/edit/closebrackets.js",test:h("autoCloseBrackets"),done:function(e){m(e,"autoCloseBrackets",!0)}},highlight:{url:"/js/vendor/codemirror5/addon/search/match-highlighter.js",test:h("highlightSelectionMatches"),done:function(e){m(e,"highlightSelectionMatches",!0)}},vim:{url:["/js/vendor/codemirror5/keymap/vim.js"],test:h("vimMode"),done:function(e){m(e,"vimMode",!0),m(e,"showCursorWhenSelecting",!0)}},emacs:{url:["/js/vendor/codemirror5/keymap/emacs.js"],test:function(){return o.keyMap.emacs},done:function(e){m(e,"keyMap","emacs")}},matchtags:{url:["/js/vendor/codemirror5/addon/fold/xml-fold.js","/js/vendor/codemirror5/addon/edit/matchtags.js"],test:function(){return o.scanForClosingTag&&o.optionHandlers.matchTags},done:function(e){m(e,"matchTags",{bothTags:!0}),e.addKeyMap({"Ctrl-J":"toMatchingTag"})}},trailingspace:{url:"/js/vendor/codemirror5/addon/edit/trailingspace.js",test:h("showTrailingSpace"),done:function(e){m(e,"showTrailingSpace",!0)}},fold:{url:["/js/vendor/codemirror5/addon/fold/foldgutter.css","/js/vendor/codemirror5/addon/fold/foldcode.js","/js/vendor/codemirror5/addon/fold/foldgutter.js","/js/vendor/codemirror5/addon/fold/brace-fold.js","/js/vendor/codemirror5/addon/fold/xml-fold.js","/js/vendor/codemirror5/addon/fold/comment-fold.js"],test:function(){return o.helpers.fold&&o.optionHandlers.foldGutter&&o.optionHandlers.gutters},done:function(e){a.addClass("code-fold"),e.addKeyMap({"Ctrl-Q":function(e){e.foldCode(e.getCursor())}}),m(e,"foldGutter",!0);var t=e.getOption("gutters").slice();t.push("CodeMirror-foldgutter"),m(e,"gutters",t)}},sublime:{url:["/js/vendor/codemirror5/keymap/sublime.js"],test:function(){return o.keyMap.sublime},done:function(t){m(t,"keyMap","sublime");var n="mac"===e.browser.platform?"Cmd":"Ctrl";delete o.keyMap.sublime[n+"-L"],delete o.keyMap.sublime[n+"-T"],delete o.keyMap.sublime[n+"-W"],delete o.keyMap.sublime[n+"-J"],delete o.keyMap.sublime[n+"-R"],delete o.keyMap.sublime[n+"-Enter"],delete o.keyMap.sublime[n+"-Up"],delete o.keyMap.sublime[n+"-Down"],o.keyMap.sublime["Shift-Tab"]="indentAuto",t.removeKeyMap("noEmmet")}},tern:{url:["/js/vendor/codemirror5/addon/hint/show-hint.css","/js/vendor/codemirror5/addon/tern/tern.css","/js/vendor/codemirror5/addon/hint/show-hint.js","/js/prod/addon-tern-"+t.version+".min.js"],test:function(){return void 0!==window.ternBasicDefs&&o.showHint&&o.TernServer&&o.startTern},done:function(){o.startTern()}},activeline:{url:["/js/vendor/codemirror5/addon/selection/active-line.js"],test:function(){return void 0!==o.defaults.styleActiveLine},done:function(e){m(e,"styleActiveLine",!0)}},matchbrackets:{url:[],test:function(){return void 0!==o.defaults.matchBrackets},done:function(e){m(e,"matchBrackets",!0)}},csshint:{url:["/js/vendor/csslint/csslint.min.js","/js/vendor/cm_addons/lint/css-lint.js"],test:function(){return p("css")&&"undefined"!=typeof CSSLint},done:function(e){"css"===e.getOption("mode")&&(void 0!==r.css&&"css"!==r.css||hintingDone(e))}},jshint:{url:[e.browser.msie&&e.browser.version<9?"/js/vendor/jshint/jshint.old.min.js":"/js/vendor/jshint/jshint.min.js"],test:function(){return p("javascript")&&"undefined"!=typeof JSHINT},done:function(e){"javascript"===e.getOption("mode")&&(void 0!==r.javascript&&"javascript"!==r.javascript||hintingDone(e,{eqnull:!0}))}},htmlhint:{url:["/js/vendor/htmlhint/htmlhint.js","/js/vendor/cm_addons/lint/html-lint.js"],test:function(){return p("htmlmixed")&&"undefined"!=typeof HTMLHint},done:function(e){"htmlmixed"===e.getOption("mode")&&(void 0!==r.html&&"html"!==r.html||hintingDone(e))}},coffeescripthint:{url:["/js/vendor/coffeelint/coffeelint.min.js","/js/vendor/cm_addons/lint/coffeescript-lint.js"],test:function(){return p("coffeescript")&&"undefined"!=typeof coffeelint},done:function(e){"coffeescript"===e.getOption("mode")&&"coffeescript"===t.state.processors.javascript&&hintingDone(e)}}},a=e("body");window.hintingDone=function(n,o){var r=n.getOption("mode");"javascript"===r&&(r="js"),"htmlmixed"===r&&(r="html");var s=e.extend({},d);if(s.consoleParent=n.getWrapperElement().parentNode.parentNode,m(n,"lintOpt",s),s.gutter){var l=n.getOption("gutters");if(-1===l.indexOf("CodeMirror-lint-markers")){var c=l.slice();c.push("CodeMirror-lint-markers"),m(n,"gutters",c)}var a=n.getOption("lineNumbers");m(n,"lineNumbers",!a),m(n,"lineNumbers",a)}m(n,"lint",{delay:800,options:e.extend({},o,t.settings[r+"hintOptions"])}),s.console&&n.consolelint&&($document.trigger("sizeeditors"),e(n.consolelint.head).on("click",function(){i||e(this).nextAll().toggle(),setTimeout(function(){$document.trigger("sizeeditors")},10)}))};var u=Object.keys(l);u.forEach(v),window.reloadAddons=function(e){e?e.forEach(v):u.forEach(v)}}function f(n){if(0!==n.indexOf("http")&&(n=t.static+n),".js"===n.slice(-3))return e.ajax({url:n+"?"+t.version,dataType:"script",cache:!0});if(".css"===n.slice(-4)){var o=e.Deferred();return setTimeout(function(){a.append('<link rel="stylesheet" href="'+n+"?"+t.version+'">'),o.resolve()},0),o}}function m(e,t,n){e.setOption(t,n)}function h(e){return function(){return void 0!==o.optionHandlers[e]}}function p(e){return void 0!==o.defaults.lint&&o.helpers.lint&&o.helpers.lint[e]&&o.optionHandlers.lint}function v(n){var o=c[n];o&&l[n]&&("string"==typeof o.url&&(o.url=[o.url]),e.when.call(e,o.url.map(f)).done(function(){o.done&&function(t){var n=e.Deferred(),o=null;if(t())n.resolve();else{var r=(new Date).getTime(),i=new Date;o=setInterval(function(){i=new Date,t()?(clearInterval(o),n.resolve()):i.getTime()-r>1e4&&(clearInterval(o),n.reject())},100)}return n}(o.test).then(function(){t.panels.allEditors(function(e){e.editor&&o.done(e.editor)})})}))}});
//# sourceMappingURL=../sourcemaps/editors/addons.js.map
