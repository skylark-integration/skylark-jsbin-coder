/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","../coder","./autocomplete","./panels"],function(e,t,s,i,a){var n=!1,r=t.objectValue("settings.keys",t)||{};function o(){t.settings.keys||(t.settings.keys={}),t.settings.keys.useAlt=this.checked,settings.save()}e("input.enablealt").attr("checked",!!r.useAlt).change(o),r.disabled?t.$body.addClass("nokeyboardshortcuts"):t.$body.keydown(h);var l={start:48},c=navigator.userAgent;-1!==c.indexOf(" Mac ")?e.browser.platform="mac":/windows|win32/.test(c)?e.browser.platform="win":/linux/.test(c)?e.browser.platform="linux":e.browser.platform="",r.disabled||t.$document.keydown(function(s){var i=r.useAlt?s.altKey:!s.altKey,n=r.closePanel?r.closePanel:48;if(s.ctrlKey&&"mac"!==e.browser.platform&&(s.metaKey=!0),s.metaKey&&79===s.which)e("a.homebtn").trigger("click","keyboard"),s.preventDefault();else if(s.metaKey&&s.shiftKey&&8===s.which)e("a.deletebin:first").trigger("click","keyboard"),s.preventDefault();else if(!t.embed&&s.metaKey&&83===s.which){if(!1===s.shiftKey)t.saveChecksum?(t.saveChecksum=!1,t.$document.trigger("snapshot")):e("a.save:first").click(),s.preventDefault();else if(!0===s.shiftKey){e("#sharemenu").hasClass("open"),e("#sharemenu a").trigger("mousedown"),s.preventDefault()}}else s.which===n&&s.metaKey&&i&&a.focused?a.hide(a.focused.id):220===s.which&&(s.metaKey||s.ctrlKey)?(t.settings.hideheader=!t.settings.hideheader,t.$body[t.settings.hideheader?"addClass":"removeClass"]("hideheader")):76===s.which&&s.ctrlKey&&a.named.console.visible&&(s.shiftKey?jsconsole.reset():jsconsole.clear())});function h(s){s=function(e){var t={type:e.type,which:e.which,metaKey:e.metaKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,orig:e};null!==e.which||null===e.charCode&&null===e.keyCode||(t.which=null!==e.charCode?e.charCode:e.keyCode);!e.metaKey&&e.ctrlKey&&(t.metaKey=e.ctrlKey);0===e.which&&!0===e.ctrlKey&&!0===e.shiftKey&&"keydown"===e.type&&(t.which=191);var s=e.stop;return t.stop=function(){t.stopping=!0,s&&s.call(e)},t}(s);var c={};a.focused&&a.focused.editor?c=a.focused.editor:a.focused&&(c=a.focused);var h={css:1,javascript:1,html:1}[c.id],d=!1,y=r.useAlt?s.altKey:!s.altKey;if("keydown"===s.type){if(h&&s.metaKey&&13===s.which&&(a.named.console.visible&&!a.named.live.visible?(d=!0,e("#runconsole").trigger("click","keyboard")):(a.named.live.visible,e("#runwithalerts").trigger("click","keyboard"),d=!0),d?s.stop():sendReload()),void 0!==l[s.which]&&s.metaKey&&y)if(a.focused.id===l[s.which])a.hide(l[s.which]),s.stop();else if(a.show(l[s.which]),s.stop(),!(r.useAlt||t.settings.keys&&t.settings.keys.seenWarning)){var u="mac"===e.browser.platform?"cmd":"ctrl";t.settings.keys||(t.settings.keys={}),t.settings.keys.seenWarning=!0,t.$document.trigger("tip",{type:"notification",content:'<label><input type="checkbox" class="enablealt"> <strong>Turn this off</strong>. Reserve '+u+"+[n] for switching browser tabs and use "+u+"+<u>alt</u>+[n] to switch JS Bin panels. You can access this any time in <strong>Help&rarr;Keyboard</strong></label>"}),e("#tip").delegate("input.enablealt","click",function(){o.call(this),window.location.reload()})}if(191===s.which&&s.metaKey&&s.shiftKey)opendropdown(e("#help").prev()[0]),s.stop();else if(27===s.which&&n)t.$body.removeClass("keyboardHelp"),n=!1,s.stop();else if(27===s.which&&a.focused&&h);else if(190===s.which&&y&&s.metaKey&&"html"===c.id){if(c.somethingSelected())return;var f=c.getCursor(!1),g=c.getTokenAt(f);/^[\w$_]*$/.test(g.string)||(g={start:f.ch,end:f.ch,string:"",state:g.state,className:"."===g.string?"js-property":null}),c.replaceRange("</"+g.state.htmlState.context.tagName+">",{line:f.line,ch:g.end},{line:f.line,ch:g.end}),s.stop()}else if(188===s.which&&s.ctrlKey&&s.shiftKey&&h)return s.stop(),i.startTagComplete(c)}if(s.stopping)return!1}return s.editors.keycontrol=h});
//# sourceMappingURL=../sourcemaps/editors/keycontrol.js.map
