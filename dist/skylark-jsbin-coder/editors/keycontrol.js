/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","../coder","./autocomplete","./panels"],function(e,t,s,i,a){var n=!1,l=objectValue("settings.keys",t)||{};function r(){t.settings.keys||(t.settings.keys={}),t.settings.keys.useAlt=this.checked,settings.save()}e("input.enablealt").attr("checked",!!l.useAlt).change(r),l.disabled?$body.addClass("nokeyboardshortcuts"):$body.keydown(h);var o={start:48},c=navigator.userAgent;-1!==c.indexOf(" Mac ")?e.browser.platform="mac":/windows|win32/.test(c)?e.browser.platform="win":/linux/.test(c)?e.browser.platform="linux":e.browser.platform="",l.disabled||$document.keydown(function(s){var i=l.useAlt?s.altKey:!s.altKey,a=l.closePanel?l.closePanel:48;if(s.ctrlKey&&"mac"!==e.browser.platform&&(s.metaKey=!0),s.metaKey&&79===s.which)e("a.homebtn").trigger("click","keyboard"),s.preventDefault();else if(s.metaKey&&s.shiftKey&&8===s.which)e("a.deletebin:first").trigger("click","keyboard"),s.preventDefault();else if(!t.embed&&s.metaKey&&83===s.which){if(!1===s.shiftKey)saveChecksum?(saveChecksum=!1,$document.trigger("snapshot")):e("a.save:first").click(),s.preventDefault();else if(!0===s.shiftKey){e("#sharemenu").hasClass("open"),e("#sharemenu a").trigger("mousedown"),s.preventDefault()}}else s.which===a&&s.metaKey&&i&&t.panels.focused?t.panels.hide(t.panels.focused.id):220===s.which&&(s.metaKey||s.ctrlKey)?(t.settings.hideheader=!t.settings.hideheader,$body[t.settings.hideheader?"addClass":"removeClass"]("hideheader")):76===s.which&&s.ctrlKey&&t.panels.panels.console.visible&&(s.shiftKey?jsconsole.reset():jsconsole.clear())});function h(s){s=function(e){var t={type:e.type,which:e.which,metaKey:e.metaKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,orig:e};null!==e.which||null===e.charCode&&null===e.keyCode||(t.which=null!==e.charCode?e.charCode:e.keyCode);!e.metaKey&&e.ctrlKey&&(t.metaKey=e.ctrlKey);0===e.which&&!0===e.ctrlKey&&!0===e.shiftKey&&"keydown"===e.type&&(t.which=191);var s=e.stop;return t.stop=function(){t.stopping=!0,s&&s.call(e)},t}(s);var c={};t.panels.focused&&t.panels.focused.editor?c=t.panels.focused.editor:t.panels.focused&&(c=t.panels.focused);var h={css:1,javascript:1,html:1}[c.id],d=!1,y=l.useAlt?s.altKey:!s.altKey;if("keydown"===s.type){if(h&&s.metaKey&&13===s.which&&(a.named.console.visible&&!a.named.live.visible?(d=!0,e("#runconsole").trigger("click","keyboard")):(a.named.live.visible,e("#runwithalerts").trigger("click","keyboard"),d=!0),d?s.stop():sendReload()),void 0!==o[s.which]&&s.metaKey&&y)if(t.panels.focused.id===o[s.which])t.panels.hide(o[s.which]),s.stop();else if(t.panels.show(o[s.which]),s.stop(),!(l.useAlt||t.settings.keys&&t.settings.keys.seenWarning)){var p="mac"===e.browser.platform?"cmd":"ctrl";t.settings.keys||(t.settings.keys={}),t.settings.keys.seenWarning=!0,$document.trigger("tip",{type:"notification",content:'<label><input type="checkbox" class="enablealt"> <strong>Turn this off</strong>. Reserve '+p+"+[n] for switching browser tabs and use "+p+"+<u>alt</u>+[n] to switch JS Bin panels. You can access this any time in <strong>Help&rarr;Keyboard</strong></label>"}),e("#tip").delegate("input.enablealt","click",function(){r.call(this),window.location.reload()})}if(191===s.which&&s.metaKey&&s.shiftKey)opendropdown(e("#help").prev()[0]),s.stop();else if(27===s.which&&n)$body.removeClass("keyboardHelp"),n=!1,s.stop();else if(27===s.which&&t.panels.focused&&h);else if(190===s.which&&y&&s.metaKey&&"html"===c.id){if(c.somethingSelected())return;var u=c.getCursor(!1),f=c.getTokenAt(u);/^[\w$_]*$/.test(f.string)||(f={start:u.ch,end:u.ch,string:"",state:f.state,className:"."===f.string?"js-property":null}),c.replaceRange("</"+f.state.htmlState.context.tagName+">",{line:u.line,ch:f.end},{line:u.line,ch:f.end}),s.stop()}else if(188===s.which&&s.ctrlKey&&s.shiftKey&&h)return s.stop(),i.startTagComplete(c)}if(s.stopping)return!1}return s.editors.keycontrol=h});
//# sourceMappingURL=../sourcemaps/editors/keycontrol.js.map
