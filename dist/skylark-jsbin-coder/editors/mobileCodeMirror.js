/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","../jsbin","./codemirror"],function(t,e,n){var i=function(){},r=document.body.className,a=null;(e.settings.editor&&e.settings.editor.simple||e.mobile||e.tablet||-1!==r.indexOf("ie6")||-1!==r.indexOf("ie7"))&&(t("body").addClass("mobile"),function(){var r=/\b./g;e.lameEditor=!0;var o=function(t,e){e||(e=t);var n=this.textarea,i=n.value;if(n.value="",n.value=i,n.setSelectionRange)n.setSelectionRange(t,e);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),t<0&&(t=n.value.length+t),r.moveEnd("character",e),r.moveStart("character",t),r.select()}},s=function(t,e,n){var i=this.textarea;void 0!==t&&null!==t||(t=""),e||(e=this.getCursor()),n||(n=e,this.textarea.selectionEnd!==this.textarea.selectionStart&&(n=this.posFromIndex(this.textarea.selectionEnd)));i.value;var r=i.value.split("\n"),a=r[e.line];a=a.substring(0,e.ch)+t+a.substring(n.ch),r[e.line]=a,i.value=r.join("\n");var s=r.slice(0,e.line).join("\n").length+1+e.ch+t.length;o.call({textarea:i},s)},u=function(n,i){this.textarea=n,this.win={document:this.textarea},this.ready=!0,this.wrapping=document.createElement("div");var r=this.textarea.parentNode;this.wrapping.appendChild(this.textarea),r.appendChild(this.wrapping),this.textarea.style.opacity=1;var a=e.mobile||e.tablet?"blur":"keyup",o=null,s=function(){o!==n.value&&(o=n.value,$document.trigger("codeChange",{panelId:n.id}))};$document.on("jsbinReady",function(){o=n.value}),t(this.textarea).on(a,e.throttle(function(){s(),$body.removeClass("editor-focus")},200)).on("focus",function(){hideOpen(),$body.addClass("editor-focus")}).on("touchstart",function(){l=-1}).on("keypress",function(){l=-1}),i.initCallback&&t(i.initCallback),this.commands={},this.options=i,this.__update=s},l=-1,c=[],h=null;for(var d in u.prototype={_hasCompletions:function(){return-1!==l},_completionIndex:l,_showCompletion:function(t,e){-1===l&&(console.log(t),c=t,h=e,console.log(e)),++l>=c.length&&(l=0);var n=this.getCursor(),i=this.indexFromPos(n),r=c[l].substr(h.string.length);s.call(this,r),this.setCursor(i,i+r.length)},cursorCoords:function(t){var e=getCaretCoordinates(this.textarea,this.textarea.selectionEnd);return e.bottom=e.top,e},replaceRange:function(){return this._completionIndex=-1,s.apply(this,arguments)},getMode:function(){return this.options.mode},Pos:function(t,e){return{line:t,ch:e}},getWrapperElement:function(){return this.wrapping},getScrollerElement:function(){return this.textarea},setOption:function(e,n){"onChange"===e&&t(this.textarea).change(n)},setCode:function(t){this.textarea.value=t},getOption:i,getCode:function(){return this.textarea.value},getLine:function(t){return this.textarea.value.split("\n")[t-1]},getValue:function(){return this.textarea.value},setValue:function(t){this.textarea.value=t},focus:function(){this.textarea.focus()},getCursor:function(){var t=this.cursorPosition().character,e=this.textarea.value.substring(0,t).split("\n"),n=e.length-1,i=e[n].length;return{line:n,char:i,ch:i}},getTokenAt:function(t){var e=this.textarea.value.split("\n")[t.line],n=(e.substr(0,t.char),-1);e.replace(r,function(t,i){e.substr(i).trim()&&(n=i)});var i=(r.exec(e.substr(t.char))||{index:e.length}).index,a=e.substr(n,i);return/^\w+$/g.test(a)||(a=""),{start:n,end:i,string:a.trim(),type:"variable",state:{mode:this.options.mode}}},setCursor:o,currentLine:function(){return 0},defaultTextHeight:function(){return 16},highlightLines:function(){return{string:""}},removeKeyMap:i,addKeyMap:i,indentLine:i,cursorPosition:function(){var t=0;return this.textarea.selectionStart?t=this.textarea.selectionStart:this.textarea.createTextRange&&(t=this.textarea.createTextRange().startOffset),{character:t}},nthLine:i,refresh:i,selectLines:i,on:i,somethingSelected:i,indexFromPos:function(t){return this.textarea.value.split("\n").slice(0,t.line).join("").length+t.ch+t.line},posFromIndex:function(t){var e=this.textarea.value.substr(0,t).split("\n"),n=e.length-1;return{line:n,ch:e[n].length}},getRange:function(t,e){return this.textarea.value.substring(this.indexFromPos(t),this.indexFromPos(e))},getModeAt:function(){var t=this.options.mode;return"htmlmixed"===t&&(t="html"),{name:t}},setSelections:function(t){o.call(this,this.indexFromPos(t[0].anchor),this.indexFromPos(t[0].head))},listSelections:function(){return[{head:this.getCursor(),anchor:this.getCursor()}]},operation:function(t){t()}},a=n,n=i,a)n[d]=i;["Pass","hint","snippets","execCommand","simpleHint","commands"].forEach(function(t){n[t]=a[t]}),n.fromTextArea=function(t,e){return new u(t,e)},n.keyMap={basic:{}}}())});
//# sourceMappingURL=../sourcemaps/editors/mobileCodeMirror.js.map
