/**
 * skylark-jsbin-coder - A version of jsbin-editor  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-coder/
 * @license MIT
 */
define(["skylark-jquery","skylark-jsbin-chrome/hideOpen","../jsbin","./codemirror"],function(t,e,n,i){var r=function(){},a=document.body.className,s=null;(n.settings.editor&&n.settings.editor.simple||n.mobile||n.tablet||-1!==a.indexOf("ie6")||-1!==a.indexOf("ie7"))&&(t("body").addClass("mobile"),function(){var a=/\b./g;n.lameEditor=!0;var o=function(t,e){e||(e=t);var n=this.textarea,i=n.value;if(n.value="",n.value=i,n.setSelectionRange)n.setSelectionRange(t,e);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),t<0&&(t=n.value.length+t),r.moveEnd("character",e),r.moveStart("character",t),r.select()}},u=function(t,e,n){var i=this.textarea;void 0!==t&&null!==t||(t=""),e||(e=this.getCursor()),n||(n=e,this.textarea.selectionEnd!==this.textarea.selectionStart&&(n=this.posFromIndex(this.textarea.selectionEnd)));i.value;var r=i.value.split("\n"),a=r[e.line];a=a.substring(0,e.ch)+t+a.substring(n.ch),r[e.line]=a,i.value=r.join("\n");var s=r.slice(0,e.line).join("\n").length+1+e.ch+t.length;o.call({textarea:i},s)},l=function(i,r){this.textarea=i,this.win={document:this.textarea},this.ready=!0,this.wrapping=document.createElement("div");var a=this.textarea.parentNode;this.wrapping.appendChild(this.textarea),a.appendChild(this.wrapping),this.textarea.style.opacity=1;var s=n.mobile||n.tablet?"blur":"keyup",o=null,u=function(){o!==i.value&&(o=i.value,$document.trigger("codeChange",{panelId:i.id}))};$document.on("jsbinReady",function(){o=i.value}),t(this.textarea).on(s,n.throttle(function(){u(),$body.removeClass("editor-focus")},200)).on("focus",function(){e(),$body.addClass("editor-focus")}).on("touchstart",function(){c=-1}).on("keypress",function(){c=-1}),r.initCallback&&t(r.initCallback),this.commands={},this.options=r,this.__update=u},c=-1,h=[],d=null;for(var g in l.prototype={_hasCompletions:function(){return-1!==c},_completionIndex:c,_showCompletion:function(t,e){-1===c&&(console.log(t),h=t,d=e,console.log(e)),++c>=h.length&&(c=0);var n=this.getCursor(),i=this.indexFromPos(n),r=h[c].substr(d.string.length);u.call(this,r),this.setCursor(i,i+r.length)},cursorCoords:function(t){var e=getCaretCoordinates(this.textarea,this.textarea.selectionEnd);return e.bottom=e.top,e},replaceRange:function(){return this._completionIndex=-1,u.apply(this,arguments)},getMode:function(){return this.options.mode},Pos:function(t,e){return{line:t,ch:e}},getWrapperElement:function(){return this.wrapping},getScrollerElement:function(){return this.textarea},setOption:function(e,n){"onChange"===e&&t(this.textarea).change(n)},setCode:function(t){this.textarea.value=t},getOption:r,getCode:function(){return this.textarea.value},getLine:function(t){return this.textarea.value.split("\n")[t-1]},getValue:function(){return this.textarea.value},setValue:function(t){this.textarea.value=t},focus:function(){this.textarea.focus()},getCursor:function(){var t=this.cursorPosition().character,e=this.textarea.value.substring(0,t).split("\n"),n=e.length-1,i=e[n].length;return{line:n,char:i,ch:i}},getTokenAt:function(t){var e=this.textarea.value.split("\n")[t.line],n=(e.substr(0,t.char),-1);e.replace(a,function(t,i){e.substr(i).trim()&&(n=i)});var i=(a.exec(e.substr(t.char))||{index:e.length}).index,r=e.substr(n,i);return/^\w+$/g.test(r)||(r=""),{start:n,end:i,string:r.trim(),type:"variable",state:{mode:this.options.mode}}},setCursor:o,currentLine:function(){return 0},defaultTextHeight:function(){return 16},highlightLines:function(){return{string:""}},removeKeyMap:r,addKeyMap:r,indentLine:r,cursorPosition:function(){var t=0;return this.textarea.selectionStart?t=this.textarea.selectionStart:this.textarea.createTextRange&&(t=this.textarea.createTextRange().startOffset),{character:t}},nthLine:r,refresh:r,selectLines:r,on:r,somethingSelected:r,indexFromPos:function(t){return this.textarea.value.split("\n").slice(0,t.line).join("").length+t.ch+t.line},posFromIndex:function(t){var e=this.textarea.value.substr(0,t).split("\n"),n=e.length-1;return{line:n,ch:e[n].length}},getRange:function(t,e){return this.textarea.value.substring(this.indexFromPos(t),this.indexFromPos(e))},getModeAt:function(){var t=this.options.mode;return"htmlmixed"===t&&(t="html"),{name:t}},setSelections:function(t){o.call(this,this.indexFromPos(t[0].anchor),this.indexFromPos(t[0].head))},listSelections:function(){return[{head:this.getCursor(),anchor:this.getCursor()}]},operation:function(t){t()}},s=i,i=r,s)i[g]=r;["Pass","hint","snippets","execCommand","simpleHint","commands"].forEach(function(t){i[t]=s[t]}),i.fromTextArea=function(t,e){return new l(t,e)},i.keyMap={basic:{}}}())});
//# sourceMappingURL=../sourcemaps/editors/mobileCodeMirror.js.map
